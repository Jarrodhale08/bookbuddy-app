================================================================================
                    BOOKBUDDY - PRE-PUBLICATION CHECKLIST
================================================================================

Last Updated: December 22, 2024

================================================================================
FIRST: RUN DATABASE MIGRATION
================================================================================

Before testing, you MUST run the Supabase migration to create the database
schema. The migration file is at: supabase/migrations/001_initial_schema.sql

OPTION 1: Via Supabase Dashboard (Recommended)
    1. Log into https://supabase.com/dashboard
    2. Select project: J&H Tech | Build
    3. Go to SQL Editor
    4. Copy/paste contents of supabase/migrations/001_initial_schema.sql
    5. Click "Run" to execute
    6. Verify tables created in Table Editor

OPTION 2: Via Supabase CLI
    1. Install CLI: npm install -g supabase
    2. Login: supabase login
    3. Link project: supabase link --project-ref kazhissaknwmagcribxq
    4. Run migration: supabase db push

Tables that will be created:
    - app_registry (shared)
    - user_app_context (shared)
    - profiles (shared)
    - books (app-isolated)
    - notes (app-isolated)
    - highlights (app-isolated)
    - reading_sessions (app-isolated)
    - reading_streaks (app-isolated)
    - reading_goals (app-isolated)
    - bookshelves (app-isolated)
    - bookshelf_items (app-isolated)

All app-isolated tables have:
    - app_id column for multi-tenant isolation
    - RLS policies for user data protection
    - Indexes for query performance

================================================================================
REQUIRED - Must complete before App Store/Play Store submission
================================================================================

[ ] REVENUECAT SETUP
    - Create account at https://revenuecat.com
    - Create new project for BookBuddy
    - Copy API key to .env as EXPO_PUBLIC_REVENUECAT_API_KEY
    - See REVENUECAT_SETUP.md for detailed instructions

[ ] APP STORE PRODUCTS (iOS)
    - Log into App Store Connect
    - Create auto-renewable subscription group
    - Add products:
      * Monthly subscription ($4.99/month)
      * Yearly subscription ($39.99/year)
    - Configure 7-day free trial on subscriptions
    - Import products into RevenueCat

[ ] GOOGLE PLAY PRODUCTS (Android)
    - Log into Google Play Console
    - Navigate to Monetize > Subscriptions
    - Create matching subscription products with same IDs as iOS
    - Configure free trial offers
    - Import products into RevenueCat

[ ] REVENUECAT CONFIGURATION
    - Create entitlement: "bookbuddy_pro"
    - Attach all subscription products to the entitlement
    - Create "default" Offering with Monthly/Yearly packages
    - Design paywall using RevenueCat's visual Paywall Editor
    - Attach paywall to default offering

[ ] SUPABASE AUTH CONFIGURATION
    - Log into Supabase dashboard (https://supabase.com/dashboard)
    - Select project: J&H Tech | Build
    - Go to Authentication > Providers
    - Enable Email/Password authentication
    - Configure email templates (confirmation, password reset)
    - (Optional) Enable social logins (Google, Apple)

[ ] UPDATE CONTACT EMAILS
    - Replace placeholder emails in legal documents:
      * app/settings/terms.tsx: support@bookbuddy.app
      * app/settings/privacy.tsx: privacy@bookbuddy.app
    - Set up actual email addresses or use your real contact info

[ ] APP STORE ASSETS
    - App icon: Already created (1024x1024)
    - Screenshots (required sizes):
      * iPhone 6.7" (1290 x 2796)
      * iPhone 6.5" (1284 x 2778)
      * iPhone 5.5" (1242 x 2208)
      * iPad Pro 12.9" (2048 x 2732)
    - App preview video (optional but recommended)
    - App description (short and full)
    - Keywords for App Store optimization
    - Privacy policy URL (host the policy online)

[ ] GOOGLE PLAY ASSETS
    - Feature graphic (1024 x 500)
    - Screenshots for phone and tablet
    - Short description (80 chars max)
    - Full description (4000 chars max)

[ ] EAS BUILD CONFIGURATION
    - Run: npx eas build:configure
    - Update eas.json with your Apple/Google credentials
    - Configure code signing for iOS
    - Configure keystore for Android

================================================================================
RECOMMENDED - Important for quality release
================================================================================

[ ] TESTING
    - Test book scanning/barcode functionality
    - Test manual book entry
    - Test reading progress tracking
    - Test reading goal setting and tracking
    - Test book shelves/collections
    - Test search and filtering
    - Test favorites and wishlist
    - Test subscription flow with sandbox accounts
    - Test login/signup/password reset flows
    - Test reading statistics and charts
    - Test push notifications on real devices
    - Test offline functionality
    - Test data sync when coming back online

[ ] SANDBOX TESTING ACCOUNTS
    - iOS: Add sandbox testers in App Store Connect > Users > Sandbox
    - Android: Add license testers in Play Console > Setup > License testing
    - Never use real payment methods during testing

[ ] PUSH NOTIFICATION CERTIFICATES
    - iOS: Create APNs key in Apple Developer portal
    - Android: Set up Firebase Cloud Messaging (FCM)
    - Configure in Expo/EAS dashboard

[ ] APP PRIVACY DETAILS (App Store)
    - Complete App Privacy questionnaire in App Store Connect
    - Document all data collection practices
    - Match with Privacy Policy content

[ ] DATA SAFETY FORM (Google Play)
    - Complete Data Safety form in Play Console
    - Document all data collection and sharing practices

================================================================================
PRODUCTION DEPLOYMENT
================================================================================

[ ] MIGRATE TO PRODUCTION SUPABASE (after testing complete)
    1. Run the same migration SQL on Production project:
       - Log into Supabase dashboard
       - Select project: J&H Tech | Production
       - Go to SQL Editor
       - Run supabase/migrations/001_initial_schema.sql
    2. Update .env with Production credentials:
       * EXPO_PUBLIC_SUPABASE_URL=https://aweahqgyrthpdxrnzaoi.supabase.co
       * EXPO_PUBLIC_SUPABASE_ANON_KEY=[production key]
    3. Verify RLS policies are working in Production
    4. Configure Auth providers in Production project

[ ] BUILD FOR PRODUCTION
    - iOS: npx eas build --platform ios --profile production
    - Android: npx eas build --platform android --profile production

[ ] SUBMIT TO STORES
    - iOS: npx eas submit --platform ios
    - Android: npx eas submit --platform android
    - Or upload manually through App Store Connect / Play Console

================================================================================
POST-LAUNCH
================================================================================

[ ] MONITOR
    - Set up RevenueCat webhooks for subscription events
    - Monitor Supabase dashboard for errors
    - Set up crash reporting (Sentry, Bugsnag, etc.)
    - Monitor app reviews and respond promptly

[ ] ANALYTICS (Optional)
    - Integrate analytics service (Mixpanel, Amplitude, etc.)
    - Track key user events and conversion funnels

================================================================================
CURRENT STATUS
================================================================================

+ Core app functionality complete
+ Supabase backend configured (Build project)
+ Database migration with full schema and RLS policies
+ Multi-tenant architecture with app_id isolation
+ Push notification infrastructure (expo-notifications)
+ RevenueCat service code integrated
+ Privacy Policy and Terms of Service
+ Open Source Licenses page
+ App icons and splash screen
+ Notification icon created
+ Auth initialization with app context
+ Sync-enabled data store

================================================================================
PREMIUM FEATURES (Gated by Subscription)
================================================================================

- Unlimited book library (free: 25 books)
- Advanced reading statistics
- Custom reading goals
- Book recommendations
- Cloud sync across devices
- Export reading history
- Multiple reading lists
- Reading challenges

================================================================================
ARCHITECTURE NOTES
================================================================================

Multi-Tenant Setup:
- APP_ID = "bookbuddy" (set in .env)
- All data tables have app_id column
- database.ts auto-filters queries by app_id
- database.ts auto-adds app_id on create/upsert
- SHARED_TABLES (profiles, app_registry) skip app_id filter

Data Flow:
- appStore.ts is the main data store
- Uses Supabase as primary storage
- AsyncStorage for offline caching
- syncAll() fetches all data on login
- Individual CRUD operations sync immediately

Auth Flow:
- authStore.ts handles Supabase auth
- On login/signup, calls initializeAppContext()
- Creates user_app_context record for multi-tenant tracking
- Creates/updates profiles record

================================================================================
